name: MONITOR
label: "Monitor"
description: "集齐Promethus、Alermanager、Node Exporter和Grafana一体的监控告警服务"
version: 1.0.0
dockerImage: "registry.mufankong.top/udh/monitor:1.0.0"
dependencies:

runAs: root

supportKerberos: false

persistencePaths:
  - /opt/udh/${serviceInstanceId}/conf
  - /opt/udh/${serviceInstanceId}/conf/rule
  - /opt/udh/${serviceInstanceId}/conf/provisioning
  - /opt/udh/${serviceInstanceId}/conf/provisioning/datasources
  - /opt/udh/${serviceInstanceId}/conf/provisioning/dashboards
  - /opt/udh/${serviceInstanceId}/conf/provisioning/dashboards/grafana
  - /opt/udh/${serviceInstanceId}/log
  - /opt/udh/${serviceInstanceId}/data
  - /opt/udh/${serviceInstanceId}/data/grafana
  - /opt/udh/${serviceInstanceId}/data/prometheus
  - /opt/udh/${serviceInstanceId}/data/alertmanager
  - /opt/udh/${serviceInstanceId}/data/nodeexporter


roles:
  - name: MONITOR_PROMETHEUS
    label: Prometheus
    roleFullName: monitor-prometheus
    linkExpression: "http://${localhostname}:${conf['prometheus.http.port']}"
    sortNum: 1
    type: MASTER
    jmxPort: 9232
    fixedNum: 1

  - name: MONITOR_ALERTMANAGER
    label: "Alert Manager"
    roleFullName: monitor-alert-manager
    linkExpression: "http://${localhostname}:${conf['alertmanager.http.port']}"
    sortNum: 2
    type: MASTER
    jmxPort: 9232
    fixedNum: 1

  - name: MONITOR_NODEEXPORTER
    label: "Node Exporter"
    roleFullName: monitor-node-exporter
    linkExpression: "http://${localhostname}:${conf['nodeexporter.http.port']}"
    sortNum: 3
    type: SLAVE
    jmxPort: 9232
    minNum: 1

  - name: MONITOR_GRAFANA
    label: Grafana
    roleFullName: monitor-grafana
    linkExpression: "http://${localhostname}:${conf['grafana.http.port']}"
    sortNum: 4
    type: MASTER
    jmxPort: 9232
    fixedNum: 1





customConfigFiles: []



configurations:
  - name: prometheus.http.port
    recommendExpression: 9090
    valueType: InputNumber
    configurableInWizard: true
  - name: nodeexporter.http.port
    recommendExpression: 9101
    valueType: InputNumber
    configurableInWizard: true
  - name: alertmanager.http.port
    recommendExpression: 9093
    valueType: InputNumber
    configurableInWizard: true
  - name: grafana.http.port
    recommendExpression: 3000
    valueType: InputNumber
    configurableInWizard: true



